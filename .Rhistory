setwd(getwd())
rstudioapi::getSourceEditorContext()$path
setwd(rstudioapi::getSourceEditorContext()$path)
dirname(rstudioapi::getSourceEditorContext()$path)
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
dados <- read.table("dados.txt", header = T, sep = "\t", dec = ".")
dados
dados <- read.table("dados.txt", header = T, sep = ",", dec = ".")
dados <- read.table("dados.txt", header = T, sep = ",", dec = ".")
dados
dados <- read.table("dados.txt", header = T, sep = ",", dec = ".")
dados
hist(dados$tempo_duracao)
hist(dados$tempo_duracao, breaks = 30)
hist(dados$tempo_duracao, breaks = 10)
hist(dados$tempo_duracao, breaks = 8)
hist(dados$tempo_duracao, breaks = 7)
hist(dados$tempo_duracao, breaks = 6)
plot(dados$tempo_duracao)
hist(dados$tempo_duracao)
curve(dgamma, 0, 600,)
hist(dados$tempo_duracao, density = T)
hist(dados$tempo_duracao, density = T)
hist(dados$tempo_duracao, probability =  = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1000 , scale = 20, log = FALSE), add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1 , scale = 2, log = FALSE), add = T)
curve(dgamma(x, shape = 25 , scale = 2, log = FALSE), add = T)
curve(dgamma(x, shape = 25 , scale = 2, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 25 , scale = 2, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 1 , scale = 20, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1 , scale = 20, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 100 , scale = 1, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 100 , scale = 1, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 100 , scale = 50, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 100 , scale = 50, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 100 , scale = 30, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 100 , scale = 5, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 80 , scale = 5, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 80 , scale = 5, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 80 , scale = 7, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 80 , scale = 7, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 39 , scale = 7, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 39 , scale = 4, log = FALSE), col = 'red',add = T)
?dgamma
curve(dgamma(x, shape = 39 , rate = 4, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 39 , rate = 4, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 100 , rate = 4, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 100 , rate = 36, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 100 , rate = 26, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 100 , rate = 19, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 100 , rate = 10, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 6 , rate = 10, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 10 , scale = 10, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 5 , scale = 20, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 2 , scale = 50, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 2 , scale = 100, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.5 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dgamma(x, shape = 1.7 , scale = 100, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.7 , scale = 100, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
legend(13, 0.7, legend="Gamma(1.35; 100)",
col=parametros$config$cor, lty=1, cex=1.2)
legend(13, 0.7, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=1.2)
hist(dados$tempo_duracao, probability = T)
legend(13, 0.7, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=1.2)
legend(1, 1, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=1.2)
legend(1, 1, legend="Gamma(1.35; 100)",
col="red")
legend(500, 0.002, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=1.2)
legend(400, 0.002, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=1.2)
legend(400, 0.002, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=0.8)
legend(400, 0.002, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=0.8)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
legend(400, 0.002, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=0.8)
legend(400, 0.0034, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=0.8)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
legend(400, 0.0034, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=0.8)
library(statmod)
curve(dinvgauss(x, mean = 60, shape = 1), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, shape = 0.3), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, shape = 0.3), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, shape = 05), col = 'green',add = T)
curve(dinvgauss(x, mean = 60, shape = 20), col = 'green',add = T)
?dinvgauss
curve(dinvgauss(x, mean = 60, shape = 20, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 60, shape = 47, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 60, dispersion = 47, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, dispersion = 47, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 60, dispersion = 0.1, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, dispersion = 0.1, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 1, dispersion = 3, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 1, dispersion = 3, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 1, shape = 3, log = F), col = 'green',add = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 1, dispersion  = 3, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T)
curve(dinvgauss(x, mean = 60, dispersion  = 3, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 39, dispersion  = 3, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 1, dispersion  = 3, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 60, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T)
#curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 60, log = F), col = 'green',add = T)
legend(400, 0.0034, legend="Gamma(1.35; 100)",
col="red", lty=1, cex=0.8)
#curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 0.1, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T)
#curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 0.1, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T, ylim = c(0, 0.005))
#curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 0.1, log = F), col = 'green',add = T)
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
hist(dados$tempo_duracao, probability = T, ylim = c(0, 0.005))
curve(dgamma(x, shape = 1.35 , scale = 100, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 0.1, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T, ylim = c(0, 0.005))
curve(dgamma(x, shape = 1.35 , scale = 150, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 0.01, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 0.000001, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 0.001, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 60, dispersion  = 1, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 60, shape  = 1, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T, ylim = c(0, 0.005))
curve(dinvgauss(x, mean = 60, shape  = 1, log = F), col = 'green',add = T)
?dinvgauss()
hist(dados$tempo_duracao, probability = T, ylim = c(0, 0.005))
curve(dinvgauss(x, mean = 1, shape  = 3, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 1, dispersion  = 3, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 1, dispersion  = 70, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 1, dispersion  = 0.1, log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T, ylim = c(0, 0.005))
curve(dgamma(x, shape = 1.35 , scale = 150, log = FALSE), col = 'red',add = T)
curve(dinvgauss(x, mean = 1, dispersion  = 0.1, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 1, dispersion  = 0.1, log = F), col = 'green',add = T)
curve(dinvgauss(x, mean = 1, dispersion  = 0.1, log = F), col = 'green',add = F)
curve(dinvgauss(x, mean = 1, dispersion  = 3, log = F), col = 'green',add = F)
curve(dinvgauss(x, mean = 1, dispersion  = 2, log = F), col = 'green',add = F)
curve(dinvgauss(x, mean = 100, dispersion  = 2, log = F), col = 'green',add = F)
curve(dinvgauss(x, mean = 100, dispersion  = 1.34, log = F), col = 'green',add = F)
?dexp
hist(dados$tempo_duracao, probability = T, ylim = c(0, 0.005))
curve(dgamma(x, shape = 1.35 , scale = 150, log = FALSE), col = 'red',add = T)
curve(dexp(x,rate = 1,log = F), col = 'green',add = T)
curve(dexp(x,rate = 50,log = F), col = 'green',add = T)
hist(dados$tempo_duracao, probability = T, ylim = c(0, 0.005))
curve(dgamma(x, shape = 1.35 , scale = 150, log = FALSE), col = 'red',add = T)
curve(dexp(x,rate = 50,log = F), col = 'green',add = T)
curve(dexp(x,rate = 50,log = F), col = 'green',add = F)
curve(dexp(x,rate = 0.5,log = F), col = 'green',add = T)
curve(dexp(x,rate = 0.5,log = F), col = 'green',add = F)
curve(dexp(x,rate = 0.25,log = F), col = 'green',add = F)
install.packages("fitdistrplus")
library(fitdistrplus)
descdist(dados$tempo_duracao)
?fidist
?fitdist
fitdist(dados$tempo_duracao, distr = "invgauss")
fitdist(dados$tempo_duracao, distr = "gamma")
plot(fitdist(dados$tempo_duracao, distr = "gamma"))
hist(dados$tempo_duracao, probability = T, ylim = c(0, 0.005))
curve(dgamma(x, shape = 2.04277171 , rate = 0.01063812, log = FALSE), col = 'red',add = T)
plot(fitdist(dados$tempo_duracao, distr = "exponential"))
plot(fitdist(dados$tempo_duracao, distr = "exp"))
plot(fitdist(dados$tempo_duracao, distr = "gamma"))
plot(fitdist(dados$tempo_duracao, distr = "exp"))
plot(fitdist(dados$tempo_duracao, distr = "chisq"))
?fitdist
plot(fitdist(dados$tempo_duracao, distr = "invgauss"))
fitdist
library(fitdistrplus)
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
dados <- read.table("dados.txt", header = T, sep = ",", dec = ".")
plot(fitdist(dados$tempo_duracao, distr = "gamma"))
plot(fitdist(dados$tempo_duracao, distr = "exp"))
dados$grupo <- as.factor(dados$grupo)
summaryBy(tempo_duracao~grupo, data=dados, FUN=c(mean, sd))
library(doBy)
require(doBy)
require("doBy")
if(!require(statmod)){install.packages("statmod")}
if(!require(fitdistrplus)){install.packages("fitdistrplus")}
if(!require(doBy)){install.packages("doBy")}
if(!require(Rcmdr)){install.packages("Rcmdr")}
install.packages("Rcmdr")
if(!require(statmod)){install.packages("statmod")}
if(!require(fitdistrplus)){install.packages("fitdistrplus")}
if(!require(doBy)){install.packages("doBy")}
if(!require(Rcmdr)){install.packages("Rcmdr")}
if(!require(Rcmdr)){install.packages("Rcmdr")}
summaryBy(tempo_duracao~grupo, data=dados, FUN=c(mean, sd))
plotMeans(dados$tempo_duracao,  dados$densidade_máxima, error.bars="se")
plotMeans(dados$tempo_duracao,  dados$densidade_máxima, dados$grupo, error.bars="se")
plotMeans(dados$tempo_duracao,  dados$grupo,  error.bars="se")
with(dados, plot(densidade_máxima, tempo_duracao))
with(dados, plot(densidade_máxima, tempo_duracao))
dados
if(!require(ggplot2)){install.packages("ggplot2")}
dados
ggplot(dados, aes(x=densidade_máxima, y=tempo_duracao, color=grupo)) +
geom_point(size=6)
ajust <- vector("list", 10)
ajust[[1]] <- with(dados, glm(tempo_duracao~densidade_máxima + grupo, family = Gamma(link = "identity")))
summary(ajust[[1]])
ajust[[1]]
ajust[[1]]$fitted.values
plot(ajust[[1]]$fitted.values)
plot(dados$tempo_duracao, ajust[[1]]$fitted.values)
plot(dados$tempo_duracao- ajust[[1]]$fitted.values)
ajust[[1]] <- with(dados, glm(tempo_duracao~densidade_máxima*grupo, family = Gamma(link = "identity")))
summary(ajust[[1]])
if(!require(statmod)){install.packages("statmod")}
if(!require(fitdistrplus)){install.packages("fitdistrplus")}
if(!require(doBy)){install.packages("doBy")}
if(!require(Rcmdr)){install.packages("Rcmdr")}
if(!require(ggplot2)){install.packages("ggplot2")}
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
dados <- read.table("dados.txt", header = T, sep = ",", dec = ".")
dados$grupo <- as.factor(dados$grupo)
#Descritivo
plot(fitdist(dados$tempo_duracao, distr = "gamma"))
plot(fitdist(dados$tempo_duracao, distr = "exp"))
summaryBy(tempo_duracao~grupo, data=dados, FUN=c(mean, sd))
plotMeans(dados$tempo_duracao,  dados$grupo,  error.bars="se")
with(dados, plot(densidade_máxima, tempo_duracao))
ggplot(dados, aes(x=densidade_máxima, y=tempo_duracao, color=grupo)) +
geom_point(size=6) + ggtitle("Gráfico de dispersão dos dados")
#Modelo
ajust <- vector("list", 10)
ajust[[1]] <- glm(tempo_duracao~densidade_máxima*grupo, data = dados, family = Gamma(link = "identity"))
summary(ajust[[1]])
fit.model <- ajust[[1]]
source("envelope_gama.R")
source("envelope_gama_ident.R")
ajust <- vector("list", 3)
ajust[[1]] <- glm(tempo_duracao~densidade_máxima, data = dados, family = Gamma(link = "identity"))
ajust[[2]] <- glm(tempo_duracao~densidade_máxima + grupo, data = dados, family = Gamma(link = "identity"))
ajust[[3]] <- glm(tempo_duracao~densidade_máxima*grupo, data = dados, family = Gamma(link = "identity"))
#Testes
testes <- vector("list", 2)
testes[[1]] <- lrtest(ajust[[1]],ajust[[2]])
testes[[2]] <- lrtest(ajust[[2]],ajust[[3]])
if(!require(lmtest)){install.packages("lmtest")}
#Testes
testes <- vector("list", 2)
testes[[1]] <- lrtest(ajust[[1]],ajust[[2]])
testes[[2]] <- lrtest(ajust[[2]],ajust[[3]])
testes
y~x
if(!require(xtable)){install.packages("xtable")}
saida_teste <- data.frame(
formula = c(paste0(formulas[1], " : ", formulas[2]),
paste0(formulas[2], " : ", formulas[3]))
)
formulas <- c(tempo_duracao~densidade_máxima, tempo_duracao~densidade_máxima + grupo, tempo_duracao~densidade_máxima*grupo)
ajust[[1]] <- glm(formulas[1], data = dados, family = Gamma(link = "identity"))
ajust[[2]] <- glm(formulas[2], data = dados, family = Gamma(link = "identity"))
ajust[[3]] <- glm(formulas[3], data = dados, family = Gamma(link = "identity"))
formulas
ajust[[1]] <- glm(formulas[[1]], data = dados, family = Gamma(link = "identity"))
saida_teste <- data.frame(
formula = c(paste0(formulas[[1]], " : ", formulas[[2]]),
paste0(formulas[[2]], " : ", formulas[[3]]))
)
saida_teste
as.character(formulas)
saida_teste <- data.frame(
formula = c(paste0(as.character(formulas[[1]]), " : ", as.character(formulas[[2]])),
paste0(as.character(formulas[[2]]), " : ", as.character(formulas[[3]])))
)
saida
saida_teste
paste0(as.character(formulas[[1]]), " : ", as.character(formulas[[2]])
)
as.character(formulas[[1]])
as.character(formulas)
formulas_str <- as.character(formulas)
saida_teste <- data.frame(
formula = c(paste0(formulas_str[[1]], " : ", formulas_str[[2]]),
paste0(formulas_str[[2]], " : ", formulas_str[[3]]))
)
saida_teste
testes[[1]]
testes[[1]]
testes[[1]]$Df
saida_teste <- data.frame(
formula = c(paste0(formulas_str[[1]], " : ", formulas_str[[2]]),
paste0(formulas_str[[2]], " : ", formulas_str[[3]])),
Df = c(testes[[1]]$Df[[2]],
testes[[2]]$Df[[2]]),
Chisq = c(testes[[1]]$Chisq[[2]],
testes[[2]]$Chisq[[2]]),
p = c(testes[[1]]$`Pr(>Chisq)`[[2]],
testes[[2]]$`Pr(>Chisq)`[[2]])
)
saida_teste
saida_teste <- data.frame(
formula = c(paste0(formulas_str[[1]], " : ", formulas_str[[2]]),
paste0(formulas_str[[2]], " : ", formulas_str[[3]])),
Df = c(testes[[1]]$Df[[2]],
testes[[2]]$Df[[2]]),
Chisq = c(testes[[1]]$Chisq[[2]],
testes[[2]]$Chisq[[2]]),
p = c(testes[[1]]$`Pr(>Chisq)`[[2]],
testes[[2]]$`Pr(>Chisq)`[[2]])
); xtable(saida_teste)
#Diagnóstico
fit.model <- ajust[[3]]
source("envelope_gama_ident.R")
if(!require(car)){install.packages("car")}
ajust[[3]]
contrasts(ajust[[3]]$coefficients)
typeof(dados$grupo)
dados$grupo <- as.factor(dados$grupo)
typeof(dados$grupo)
class(dados$grupo)
ajust[[1]] <- glm(formulas[[1]], data = dados, family = Gamma(link = "identity"))
ajust[[2]] <- glm(formulas[[2]], data = dados, family = Gamma(link = "identity"))
ajust[[3]] <- glm(formulas[[3]], data = dados, family = Gamma(link = "identity"))
contrasts(ajust[[3]]$coefficients)
sumamry(ajust[[3]])
summary(ajust[[3]])
